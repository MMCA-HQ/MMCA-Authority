<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù‡ÙŠØ¦Ø© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¯ÙˆØ±Ø§Øª - Ù…Ø§Ø±ÙÙ„</title>
    <style>
        :root { --army: #3d4921; --gold: #c5a059; --dark: #0b0c08; }
        body { background: var(--dark); color: #fff; font-family: Tahoma; padding: 20px; text-align: center; }
        .container { max-width: 900px; margin: auto; background: #14160f; border: 1px solid var(--army); padding: 25px; border-radius: 12px; }
        .section { background: rgba(0,0,0,0.5); padding: 20px; margin-bottom: 25px; border-right: 5px solid var(--gold); text-align: right; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: #080905; }
        th, td { border: 1px solid #1a1d12; padding: 12px; text-align: center; }
        th { color: var(--gold); background: #0d0e0a; }
        input, select, button { padding: 12px; margin: 10px 0; border-radius: 5px; border: 1px solid #333; width: 100%; }
        .btn-apply { background: var(--gold); color: #000; font-weight: bold; cursor: pointer; }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ù‡ÙŠØ¦Ø© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ© - Ù…Ø§Ø±ÙÙ„</h1>

        <div class="section">
            <h3>| Ø´Ø±ÙˆØ· Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3>
            <div id="view_rules" style="white-space: pre-wrap; color: #ccc;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>

        <div class="section">
            <h3>| Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3>
            <table id="view_courses">
                <thead><tr><th>Ø§Ù„Ø¯ÙˆØ±Ø©</th><th>Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</th><th>Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>

        <div class="section">
            <h3>| Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚</h3>
            <form id="applyForm">
                <input type="text" id="app_name" placeholder="Ø§Ù„Ø§Ø³Ù… ÙƒØ§Ù…Ù„" required>
                <input type="text" id="app_code" placeholder="Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ" required>
                <input type="text" id="app_rank" placeholder="Ø§Ù„Ø±ØªØ¨Ø©" required>
                <input type="number" id="app_age" placeholder="Ø§Ù„Ø¹Ù…Ø±" required>
                <select id="app_course"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±Ø©</option></select>
                <select id="app_period"><option value="Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</option><option value="Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</option></select>
                <button type="submit" class="btn-apply">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
            </form>
        </div>

        <div class="section">
            <h3>| Ù„ÙˆØ­Ø© Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠ</h3>
            <table id="view_results_accept">
                <thead><tr><th>Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</th><th>Ø§Ù„Ø¯ÙˆØ±Ø©</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>

        <div class="section">
            <h3>| Ù„ÙˆØ­Ø© Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø¬ØªÙŠØ§Ø² Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h3>
            <table id="view_results_pass">
                <thead><tr><th>Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</th><th>Ø§Ù„Ø¯ÙˆØ±Ø©</th><th>Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>

        <div style="margin-top:40px; color: var(--gold);">Ø­Ù‚ÙˆÙ‚ - Ø¯ÙˆÙ„Ø© Ù…Ø§Ø±ÙÙ„ | Ù‡ÙŠØ¦Ø© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©</div>
    </div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
    const firebaseConfig = { apiKey: "AIzaSyAALZ-v8wA_5mjUVSqW1uLXMwMkskpDaGM", databaseURL: "https://mmca-authority-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
    document.getElementById('applyForm').onsubmit = (e) => {
        e.preventDefault();
        const data = {
            name: document.getElementById('app_name').value,
            code: document.getElementById('app_code').value,
            rank: document.getElementById('app_rank').value,
            age: document.getElementById('app_age').value,
            course: document.getElementById('app_course').value,
            period: document.getElementById('app_period').value,
            status: "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
            pass: "Ù„Ù… ØªØ¸Ù‡Ø± Ø¨Ø¹Ø¯",
            timestamp: Date.now()
        };
        db.ref('applications').push(data);
        db.ref('logs').push({ msg: `ğŸ“© ØªÙ‚Ø¯Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù… ${data.name} Ù„Ø¯ÙˆØ±Ø© ${data.course}`, time: new Date().toLocaleString('ar-SA') });
        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­");
        e.target.reset();
    };

    // Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    db.ref().on('value', snap => {
        const val = snap.val() || {};
        // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯
        document.getElementById('view_rules').innerText = (val.data || {}).rules || "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø±ÙˆØ· Ø­Ø§Ù„ÙŠØ§Ù‹";
        
        let hC="", hOpt="<option value=''>Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±Ø©</option>", hA="", hP="";
        for(let i in val.courses) {
            hC += `<tr><td>${val.courses[i].name}</td><td>${val.courses[i].p1}</td><td>${val.courses[i].p2}</td></tr>`;
            hOpt += `<option value="${val.courses[i].name}">${val.courses[i].name}</option>`;
        }
        for(let i in val.applications) {
            const app = val.applications[i];
            hA += `<tr><td>${app.name}</td><td>${app.course}</td><td>${app.status}</td></tr>`;
            if(app.pass !== "Ù„Ù… ØªØ¸Ù‡Ø± Ø¨Ø¹Ø¯") hP += `<tr><td>${app.name}</td><td>${app.course}</td><td>${app.pass}</td></tr>`;
        }
        document.querySelector("#view_courses tbody").innerHTML = hC;
        document.getElementById('app_course').innerHTML = hOpt;
        document.querySelector("#view_results_accept tbody").innerHTML = hA;
        document.querySelector("#view_results_pass tbody").innerHTML = hP;
    });
</script>
</body>
</html>
