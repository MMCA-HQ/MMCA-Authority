<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙŠÙ† - Ù…Ø§Ø±ÙÙ„</title>
    <style>
        :root { --army: #3d4921; --gold: #c5a059; --dark: #0b0c08; }
        body { background: var(--dark); color: #fff; font-family: Tahoma; padding: 20px; text-align: center; }
        .box { max-width: 800px; margin: auto; background: #14160f; border: 1px solid var(--army); padding: 20px; border-radius: 8px; }
        .sec { background: rgba(0,0,0,0.5); padding: 15px; margin-bottom: 20px; border-right: 4px solid var(--gold); text-align: right; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #222; padding: 10px; text-align: center; }
        input, select { background:#000; color:#fff; border:1px solid #333; padding:10px; width:100%; margin:5px 0; }
        .btn { background: var(--gold); border: none; padding: 15px; width: 100%; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <div class="box">
        <h1 style="color:var(--gold)">Ù‡ÙŠØ¦Ø© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©</h1>
        
        <div class="sec"><h3>| Ø´Ø±ÙˆØ· Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3><div id="rules_view"></div></div>

        <div class="sec"><h3>| Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3><table id="courses_view"><thead><tr><th>Ø§Ù„Ø¯ÙˆØ±Ø©</th><th>Ù1</th><th>Ù2</th></tr></thead><tbody></tbody></table></div>

        <div class="sec">
            <h3>| Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„ØªØ­Ø§Ù‚</h3>
            <input type="text" id="n" placeholder="Ø§Ù„Ø§Ø³Ù… ÙƒØ§Ù…Ù„">
            <input type="text" id="c" placeholder="Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ">
            <select id="crs"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±Ø©</option></select>
            <button class="btn" onclick="sendApp()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
        </div>

        <div class="sec"><h3>| Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù‚Ø¨ÙˆÙ„ ÙˆØ§Ù„Ø§Ø¬ØªÙŠØ§Ø²</h3><table id="res_view"><thead><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø¯ÙˆØ±Ø©</th><th>Ø§Ù„Ù‚Ø¨ÙˆÙ„</th><th>Ø§Ù„Ø§Ø¬ØªÙŠØ§Ø²</th></tr></thead><tbody></tbody></table></div>
        
        <div style="margin-top:20px; color:var(--gold)">Ø­Ù‚ÙˆÙ‚ - Ø¯ÙˆÙ„Ø© Ù…Ø§Ø±ÙÙ„</div>
    </div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script>
    const firebaseConfig = { apiKey: "AIzaSyAALZ-v8wA_5mjUVSqW1uLXMwMkskpDaGM", databaseURL: "https://mmca-authority-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function sendApp() {
        const data = { name: document.getElementById('n').value, code: document.getElementById('c').value, course: document.getElementById('crs').value, status: "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±", pass: "---" };
        if(!data.name || !data.course) return alert("Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        db.ref('applications').push(data);
        db.ref('logs').push({ msg: `ğŸ“© ØªÙ‚Ø¯ÙŠÙ… Ø¬Ø¯ÙŠØ¯ Ù…Ù†: ${data.name} Ù„Ø¯ÙˆØ±Ø© ${data.course}`, time: new Date().toLocaleString('ar-SA') });
        alert("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
    }

    db.ref().on('value', snap => {
        const d = snap.val() || {};
        document.getElementById('rules_view').innerText = d.settings?.rules || "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø±ÙˆØ·";
        
        let hC="", hOpt="<option value=''>Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ±Ø©</option>", hR="";
        for(let i in d.courses) {
            hC += `<tr><td>${i}</td><td>${d.courses[i].p1}</td><td>${d.courses[i].p2}</td></tr>`;
            hOpt += `<option value="${i}">${i}</option>`;
        }
        for(let i in d.applications) hR += `<tr><td>${d.applications[i].name}</td><td>${d.applications[i].course}</td><td>${d.applications[i].status}</td><td>${d.applications[i].pass}</td></tr>`;
        
        document.querySelector("#courses_view tbody").innerHTML = hC;
        document.getElementById('crs').innerHTML = hOpt;
        document.querySelector("#res_view tbody").innerHTML = hR;
    });
</script>
</body>
</html>
